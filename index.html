<html>
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js" charset="utf-8"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="https://kripken.github.io/sql.js/js/sql.js" charset="utf-8"></script>

    <script src="unzip.min.js" charset="utf-8"></script>
    <script src="apkg.js" charset="utf-8"></script>
    <meta charset="UTF-8">

</head>
<body>
    <script type="text/javascript">
    var foo;
        $( document ).ready(function() {
            var eventHandleToTable = function (event) {
                event.stopPropagation();
                event.preventDefault();
                var f = event.target.files[0];
                if (!f) {
                    f = event.dataTransfer.files[0];
                }
                // console.log(f.name);

                var reader = new FileReader();
                reader.onload = function(e) {ankiBinaryToTable(e.target.result);};
                /* // If the callback doesn't need the File object, just use the above.
                reader.onload = (function(theFile) {
                    return function(e) {
                        console.log(theFile.name);
                        ankiBinaryToTable(e.target.result);
                    };
                })(f);
                */
                reader.readAsArrayBuffer(f);
            };

            $("#ankiFile").change(eventHandleToTable);

        });
    </script>

    <div id="dropZone">
    Select an Anki .apkg file: <input type="file" id="ankiFile" name="files">
    </div>

    <div id="anki"></div>
</body>
</html>